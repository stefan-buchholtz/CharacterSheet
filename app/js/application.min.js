/* CharacterSheet 04-05-2014 */

"use strict";var characterSheetApp=angular.module("characterSheetApp",["ngRoute","characterSheetControllers","characterSheetServices"]);characterSheetApp.config(["$routeProvider",function(a){a.when("/character",{templateUrl:"partials/sr4/base.html",controller:"Sr4CharacterSheetCtrl"}).otherwise({redirectTo:"/character"})}]);var characterSheetControllers=angular.module("characterSheetControllers",[]);characterSheetControllers.controller("Sr4CharacterSheetCtrl",["$scope","Character",function(a,b){a.character=b.get(function(b){var c=b.data,d=c.skills.map(function(a){return a.attributeValue=c.attributes[a.attribute],a}).sort(function(a,b){return a.name.localeCompare(b.name)}),e=d.filter(function(a){return"action"===a.type}),f=d.filter(function(a){return"knowledge"===a.type});if(e.length>f.length){var g=Math.ceil(e.length/2)>f.length?Math.ceil(e.length/2):f.length;g%2===1&&g++,a.leftSkillColumn={skills:e.slice(0,g),skillType:"Aktionsfertigkeiten",repeatHeader:!1,wrapperClass:"left-column-content"},a.middleSkillColumn={skills:e.slice(g),skillType:"Aktionsfertigkeiten",repeatHeader:!0,wrapperClass:"inner-column-content"},a.rightSkillColumn={skills:f,skillType:"Wissensfertigkeiten",repeatHeader:!1,wrapperClass:"right-column-content"}}else{var g=Math.ceil(f.length/2)>e.length?Math.ceil(f.length/2):e.length;g%2===1&&g++,a.leftSkillColumn={skills:e,skillType:"Aktionsfertigkeiten",repeatHeader:!1,wrapperClass:"left-column-content"},a.middleSkillColumn={skills:f.slice(0,g),skillType:"Wissensfertigkeiten",repeatHeader:!1,wrapperClass:"inner-column-content"},a.rightSkillColumn={skills:f.slice(g),skillType:"Wissensfertigkeiten",repeatHeader:!0,wrapperClass:"right-column-content"}}a.rangedWeaponCount=c.rangedWeapons?c.rangedWeapons.length:0,a.meleeWeaponCount=c.meleeWeapons?c.meleeWeapons.length:0,a.armorCount=c.armor?c.armor.length:0,a.meleeWeaponCount&&(a.meleeWeaponDisplay=a.rangedWeaponCount+a.meleeWeaponCount<=a.armorCount?"left":"right")})}]),characterSheetControllers.directive("csSr4Attributes",function(){return{restrict:"E",scope:{attributes:"="},templateUrl:"partials/sr4/attributes.html"}}),characterSheetControllers.directive("csSr4SkillTable",function(){return{restrict:"E",scope:{content:"="},templateUrl:"partials/sr4/skills.html"}}),characterSheetControllers.directive("csSr4ConditionMonitor",function(){return{restrict:"E",templateUrl:"partials/sr4/conditionMonitor.html",scope:{attributes:"=",type:"="},link:function(a){a.cellClick=function(b){var c=Number(b.target.getAttribute("damage"));c>a.maxDamage||(a.currentDamage=c>a.currentDamage?c:c-1)};var b="physical"===a.type?"attributes.constitution":"attributes.willpower";a.$watch(b,function(b){a.maxDamage=8+Math.floor(b/2),a.currentDamage=0,a.rows=[];for(var c=0,d=0;d<a.maxDamage;d+=3){for(var e={base:d,penalty:--c,columns:[]},f=1;3>=f;f++){var g=d+f;e.columns.push({id:a.type+"-"+g,damage:g,cellClass:g<=a.maxDamage?"enabled":"disabled"})}e.columns[2].content=c,a.rows.push(e)}})}}}),characterSheetControllers.directive("csSr4RangedWeapons",function(){return{restrict:"E",scope:{weapons:"="},templateUrl:"partials/sr4/ranged_weapons.html"}}),characterSheetControllers.directive("csSr4MeleeWeapons",function(){return{restrict:"E",scope:{weapons:"="},templateUrl:"partials/sr4/melee_weapons.html"}}),characterSheetControllers.directive("csSr4Armor",function(){return{restrict:"E",scope:{armor:"="},templateUrl:"partials/sr4/armor.html"}}),characterSheetControllers.directive("csSr4Comlink",function(){return{restrict:"E",scope:{comlink:"="},templateUrl:"partials/sr4/comlink.html"}}),characterSheetControllers.directive("csSr4Cyberware",function(){return{restrict:"E",scope:{cyberware:"="},templateUrl:"partials/sr4/cyberware.html"}}),characterSheetControllers.directive("csSr4Connections",function(){return{restrict:"E",scope:{connections:"="},templateUrl:"partials/sr4/connections.html"}}),characterSheetControllers.directive("csSr4Sins",function(){return{restrict:"E",scope:{sins:"="},templateUrl:"partials/sr4/sins.html"}}),characterSheetControllers.directive("csSr4Licenses",function(){return{restrict:"E",scope:{licenses:"="},templateUrl:"partials/sr4/licenses.html"}}),characterSheetControllers.directive("csSr4Vehicles",function(){return{restrict:"E",scope:{vehicles:"="},templateUrl:"partials/sr4/vehicles.html"}}),characterSheetControllers.directive("csSr4Lifestyles",function(){return{restrict:"E",scope:{lifestyles:"="},templateUrl:"partials/sr4/lifestyles.html"}}),characterSheetControllers.directive("csSr4Equipment",function(){return{restrict:"E",scope:{equipment:"=",magic:"="},templateUrl:"partials/sr4/equipment.html"}}),characterSheetControllers.directive("csSr4Magic",function(){return{restrict:"E",scope:{magic:"="},templateUrl:"partials/sr4/magic.html"}}),characterSheetControllers.directive("csSr4MagicTradition",function(){return{restrict:"E",scope:{tradition:"="},templateUrl:"partials/sr4/magic_tradition.html"}}),characterSheetControllers.directive("csSr4MagicFoci",function(){return{restrict:"E",scope:{foci:"="},templateUrl:"partials/sr4/magic_foci.html"}}),characterSheetControllers.directive("csSr4MagicPatron",function(){return{restrict:"E",scope:{patron:"="},templateUrl:"partials/sr4/magic_patron.html"}}),characterSheetControllers.directive("csSr4MagicSpells",function(){return{restrict:"E",scope:{spells:"="},templateUrl:"partials/sr4/magic_spells.html"}}),characterSheetControllers.directive("csSr4Initiation",function(){return{restrict:"E",scope:{initiation:"=",magic:"="},templateUrl:"partials/sr4/initiation.html"}}),characterSheetControllers.directive("csSr4Spirits",function(){return{restrict:"E",scope:{spirits:"=",magic:"="},templateUrl:"partials/sr4/spirits.html"}}),characterSheetControllers.directive("csSr4AdeptPowers",function(){return{restrict:"E",scope:{adeptPowers:"="},templateUrl:"partials/sr4/adept_powers.html"}}),characterSheetControllers.directive("csSr4Technomancy",function(){return{restrict:"E",scope:{technomancy:"="},templateUrl:"partials/sr4/technomancy.html"}}),characterSheetControllers.directive("csKeyValueRow",function(){return{restrict:"E",scope:{key:"=",value:"="},template:'<div class="key-value-row" ng-show="\'{{value}}\'"><div class="key-value-key">{{key}}</div><div class="key-value-value">{{value}}</div></div>'}});var characterSheetServices=angular.module("characterSheetServices",["ngResource"]);characterSheetServices.factory("Character",["$resource",function(a){return a("api/characters/:characterId",{},{list:{method:"GET",params:{characterId:""},isArray:!0},get:{method:"GET",params:{characterId:1},isArray:!1}})}]);
//# sourceMappingURL=application.min.map